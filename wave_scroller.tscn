[gd_scene load_steps=13 format=3 uid="uid://c72l75yy5r0bq"]

[ext_resource type="Script" uid="uid://0o1va8if8h8w" path="res://wave_scroller.gd" id="1_ex7g5"]
[ext_resource type="Texture2D" uid="uid://b1u76hyp8l32d" path="res://icon.svg" id="2_fwhko"]
[ext_resource type="PackedScene" uid="uid://ccma600lghumf" path="res://wave_scene.tscn" id="3_fwhko"]
[ext_resource type="Shader" uid="uid://sdrg3m4atwd4" path="res://volumetric_waves.gdshader" id="3_hysyj"]
[ext_resource type="AudioStream" uid="uid://3anoi7pe0oio" path="res://wave.ogg" id="5_f8bmd"]
[ext_resource type="Script" uid="uid://d3y0wklf13l6n" path="res://music_controller.gd" id="6_4sxhh"]
[ext_resource type="Script" uid="uid://k65m3d8v3ewm" path="res://shader_controller.gd" id="7_uej3w"]
[ext_resource type="Script" uid="uid://b334wvs0knpo6" path="res://enemy_spawner.gd" id="8_jrdne"]

[sub_resource type="ShaderMaterial" id="ShaderMaterial_f8bmd"]
shader = ExtResource("3_hysyj")
shader_parameter/time_speed = 1.0
shader_parameter/flip_y = false
shader_parameter/sea_color_dark = Color(0.04, 0.32, 0.55, 1)
shader_parameter/sea_color_light = Color(0.06, 0.47, 0.6, 1)
shader_parameter/refraction_color = Color(0.96, 0.98, 0.86, 1)
shader_parameter/light_shaft_color = Color(0.88, 0.9, 0.78, 1)

[sub_resource type="FastNoiseLite" id="FastNoiseLite_4sxhh"]
noise_type = 2
frequency = 0.0047
fractal_lacunarity = 2.51
fractal_gain = 0.245

[sub_resource type="NoiseTexture2D" id="NoiseTexture2D_uej3w"]
width = 1152
height = 648
seamless = true
noise = SubResource("FastNoiseLite_4sxhh")

[sub_resource type="ParticleProcessMaterial" id="ParticleProcessMaterial_ex7g5"]
particle_flag_disable_z = true
spread = 112.771
initial_velocity_min = 155.17
initial_velocity_max = 281.61
angular_velocity_min = -1.60933e-05
angular_velocity_max = 513.1
gravity = Vector3(0, -20, 0)
linear_accel_min = -2.23517e-06
linear_accel_max = 27.59
scale_min = 0.05
scale_max = 0.2
color = Color(1, 0.87, 0.987, 1)
hue_variation_min = -0.16
hue_variation_max = 0.11

[node name="WaveScroller" type="Node2D" node_paths=PackedStringArray("sprite", "exhaust_particle")]
script = ExtResource("1_ex7g5")
sprite = NodePath("Icon")
exhaust_particle = NodePath("Icon/GPUParticles2D")

[node name="CanvasLayer" type="CanvasLayer" parent="."]
layer = -7

[node name="VBoxContainer" type="VBoxContainer" parent="CanvasLayer"]
anchors_preset = 4
anchor_top = 0.5
anchor_bottom = 0.5
offset_top = -20.0
offset_right = 40.0
offset_bottom = 20.0
grow_vertical = 2

[node name="SubViewportContainer" type="SubViewportContainer" parent="CanvasLayer"]
z_index = -3
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
grow_horizontal = 2
grow_vertical = 2

[node name="SubViewport" type="SubViewport" parent="CanvasLayer/SubViewportContainer"]
own_world_3d = true
transparent_bg = true
handle_input_locally = false
size = Vector2i(1152, 648)
render_target_update_mode = 4

[node name="WaveScene" parent="CanvasLayer/SubViewportContainer/SubViewport" instance=ExtResource("3_fwhko")]

[node name="TextureRect" type="TextureRect" parent="CanvasLayer"]
z_index = -5
material = SubResource("ShaderMaterial_f8bmd")
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
grow_horizontal = 2
grow_vertical = 2
texture = SubResource("NoiseTexture2D_uej3w")

[node name="Icon" type="Sprite2D" parent="."]
z_index = 1
texture = ExtResource("2_fwhko")

[node name="GPUParticles2D" type="GPUParticles2D" parent="Icon"]
z_index = 2
rotation = 1.5708
amount = 75
amount_ratio = 0.219
texture = ExtResource("2_fwhko")
process_material = SubResource("ParticleProcessMaterial_ex7g5")

[node name="AudioListener2D" type="AudioListener2D" parent="Icon"]

[node name="Camera2D" type="Camera2D" parent="."]

[node name="AudioStreamPlayer" type="AudioStreamPlayer" parent="."]
stream = ExtResource("5_f8bmd")
autoplay = true
parameters/looping = true

[node name="MusicController" type="Node" parent="." node_paths=PackedStringArray("main_loop")]
script = ExtResource("6_4sxhh")
main_loop = NodePath("../AudioStreamPlayer")

[node name="ShaderController" type="Node" parent="." node_paths=PackedStringArray("main", "wave_scene", "music_controller")]
script = ExtResource("7_uej3w")
main = NodePath("..")
wave_scene = NodePath("../CanvasLayer/SubViewportContainer/SubViewport/WaveScene")
music_controller = NodePath("../MusicController")

[node name="EnemySpawner" type="Node" parent="." node_paths=PackedStringArray("wave_scene")]
script = ExtResource("8_jrdne")
wave_scene = NodePath("../CanvasLayer/SubViewportContainer/SubViewport/WaveScene")
